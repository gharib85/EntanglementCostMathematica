(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45419,       1200]
NotebookOptionsPosition[     44289,       1160]
NotebookOutlinePosition[     44650,       1176]
CellTagsIndexPosition[     44607,       1173]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", " ", "qinf050.ma"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "qi.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.643463148840456*^9, 3.643463150967407*^9}, {
  3.643463292650922*^9, 3.643463299464776*^9}, {3.643471468508479*^9, 
  3.6434714793716497`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Get", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"Statistics`NormalDistribution`\\\"\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/noopen\\\", \
ButtonNote -> \\\"Get::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.643992401660901*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Needs", "::", "nocont"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Context \[NoBreak]\\!\\(\\\"Statistics`NormalDistribution`\
\\\"\\)\[NoBreak] was not created when Needs was evaluated. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Needs/nocont\\\", \
ButtonNote -> \\\"Needs::nocont\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.6439924017045116`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Get", "::", "noopen"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot open \
\[NoBreak]\\!\\(\\\"Statistics`NormalDistribution`\\\"\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/noopen\\\", \
ButtonNote -> \\\"Get::noopen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.6439924017554827`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Needs", "::", "nocont"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Context \[NoBreak]\\!\\(\\\"Statistics`NormalDistribution`\
\\\"\\)\[NoBreak] was not created when Needs was evaluated. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Needs/nocont\\\", \
ButtonNote -> \\\"Needs::nocont\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.643992401759438*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"cnot", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"cnot\\\"\\)\[NoBreak] appears \
in multiple contexts \[NoBreak]\\!\\({\\\"QI`\\\", \\\"Global`\\\"}\\)\
\[NoBreak]; definitions in context \[NoBreak]\\!\\(\\\"QI`\\\"\\)\[NoBreak] \
may shadow or be shadowed by other definitions. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/shdw\\\", ButtonNote -> \
\\\"QI`cnot::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.643992401813511*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"PartialTrace", "::", "shdw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Symbol \[NoBreak]\\!\\(\\\"PartialTrace\\\"\\)\[NoBreak] \
appears in multiple contexts \[NoBreak]\\!\\({\\\"QI`\\\", \
\\\"Global`\\\"}\\)\[NoBreak]; definitions in context \[NoBreak]\\!\\(\\\"QI`\
\\\"\\)\[NoBreak] may shadow or be shadowed by other definitions. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/shdw\\\", \
ButtonNote -> \\\"QI`PartialTrace::shdw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.643992401866434*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"SetDelayed", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(SquareMatrixQ\\)\[NoBreak] in \
\[NoBreak]\\!\\(SquareMatrixQ[A_]\\)\[NoBreak] is Protected. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/write\\\", \
ButtonNote -> \\\"SetDelayed::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.64346330034511*^9, 3.643463316220354*^9}, 
   3.6434714799219017`*^9, 3.643989921119574*^9, 3.6439924019066277`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package QI version \"\>", 
   "\[InvisibleSpace]", "\<\"0.4.37\"\>", 
   "\[InvisibleSpace]", "\<\" (last modification: \"\>", 
   "\[InvisibleSpace]", "\<\"21/12/2012\"\>", 
   "\[InvisibleSpace]", "\<\").\"\>"}],
  SequenceForm[
  "Package QI version ", "0.4.37", " (last modification: ", "21/12/2012", 
   ")."],
  Editable->False]], "Print",
 CellChangeTimes->{3.643471480226762*^9, 3.6439899213301*^9, 
  3.6439924019107323`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "x", ",", "y", ",", "Init1", ",", "Init2", ",", "FinalSt", ",", 
    "mkvec", ",", "Measure", ",", "RMeasure", ",", "NEntropy", ",", "A", ",", 
    "Init3"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.643467123645731*^9, 3.6434672245559673`*^9}, {
  3.6434697595881557`*^9, 3.643469760011147*^9}, {3.643558451004384*^9, 
  3.643558453705916*^9}, {3.64355958952842*^9, 3.643559592342722*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Init", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", "0", ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"a", "^", "2"}]}], "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0", ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"x", "^", "2"}]}], "]"}]}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init3", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"a", "^", "2"}]}], "]"}], ",", "0", ",", "0", ",", 
        RowBox[{"-", "a"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0", ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"x", "^", "2"}]}], "]"}]}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi1", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"a", ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi2", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", "0", ",", "0", ",", 
      RowBox[{"-", "a"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi1", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "a", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Psi2", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", 
      RowBox[{"-", "a"}], ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pri1", "[", "a_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", "a", ",", "0"}], "}"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pri2", "[", "a_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "a", ",", 
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{"a", "^", "2"}]}], "]"}]}], ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mkvec", "[", 
    RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "a1", "]"}], 
       RowBox[{"Sin", "[", "a2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "a1", "]"}], 
       RowBox[{"Cos", "[", "a2", "]"}], 
       RowBox[{"Sin", "[", "a3", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "a1", "]"}], 
       RowBox[{"Cos", "[", "a2", "]"}], 
       RowBox[{"Cos", "[", "a3", "]"}]}], ",", 
      RowBox[{"Cos", "[", "a1", "]"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Moperator", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "a", "]"}], ".", "a"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "b", "]"}], ".", "b"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FinalSt", "[", 
    RowBox[{"init_", ",", "P1_", ",", "P2_"}], "]"}], ":=", 
   RowBox[{"P2", ".", "P1", ".", "init"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init1", "=", 
   RowBox[{"permket", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "Init", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init4", "=", 
   RowBox[{"permket", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "Init3", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init2", " ", "=", " ", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"Moperator", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "A", "]"}], ",", 
        RowBox[{"Psi2", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"A", "^", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "]"}], ".", "Init1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init5", " ", "=", " ", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"Moperator", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "A", "]"}], ",", 
        RowBox[{"Psi2", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"A", "^", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "]"}], ".", "Init4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "4", "]"}], "-", 
      RowBox[{"Moperator", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "B", "]"}], ",", 
        RowBox[{"Psi1", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"B", "^", "2"}]}], "]"}], "]"}]}], "]"}]}]}], "]"}], ".", 
   "Init2", ".", "\[IndentingNewLine]", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "4", "]"}], "-", 
      RowBox[{"Moperator", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "B", "]"}], ",", 
        RowBox[{"Psi1", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"B", "^", "2"}]}], "]"}], "]"}]}], "]"}]}]}], "]"}], ".", 
   "Init5"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.643461346647622*^9, 3.6434614729561996`*^9}, {
   3.643461809733407*^9, 3.643461848882595*^9}, {3.643461949414896*^9, 
   3.6434621785479183`*^9}, {3.6434622093781443`*^9, 3.643462282734676*^9}, {
   3.643463356392358*^9, 3.643463365766157*^9}, {3.6434636307149343`*^9, 
   3.6434636346180983`*^9}, 3.64346371532721*^9, {3.643463848546307*^9, 
   3.6434639116694393`*^9}, {3.643466705358513*^9, 3.643466729026225*^9}, {
   3.643468399503703*^9, 3.6434684266294928`*^9}, {3.643468520681229*^9, 
   3.643468612173089*^9}, {3.643469194405252*^9, 3.643469345246928*^9}, {
   3.643469400714562*^9, 3.643469504733859*^9}, {3.643469541654175*^9, 
   3.643469794697503*^9}, {3.643469972689316*^9, 3.64346998989566*^9}, {
   3.6434701604165287`*^9, 3.643470160903719*^9}, {3.643470200550798*^9, 
   3.643470363855359*^9}, {3.6434704379171667`*^9, 3.643470503297591*^9}, {
   3.643470902432001*^9, 3.643470921902046*^9}, {3.643470988707388*^9, 
   3.643470994274729*^9}, {3.643471052344042*^9, 3.6434710654167213`*^9}, {
   3.643471096959713*^9, 3.643471124253912*^9}, {3.643471280286566*^9, 
   3.6434713192596893`*^9}, {3.6434714246953773`*^9, 
   3.6434714555902643`*^9}, {3.6434714859262447`*^9, 
   3.6434716877976303`*^9}, {3.6434717320658197`*^9, 3.643471931755066*^9}, {
   3.643472001949648*^9, 3.643472174244945*^9}, {3.643472218100172*^9, 
   3.64347222186694*^9}, {3.643472807925465*^9, 3.6434728330578537`*^9}, {
   3.643473199248933*^9, 3.643473202463582*^9}, {3.643541251965958*^9, 
   3.643541364612895*^9}, {3.6435419835548277`*^9, 3.643542027814863*^9}, {
   3.6435420982518044`*^9, 3.643542113924754*^9}, {3.643542150986347*^9, 
   3.643542185096089*^9}, {3.643555556358549*^9, 3.643555604343978*^9}, {
   3.6435584622011557`*^9, 3.6435585646694183`*^9}, {3.643558676866206*^9, 
   3.643558691656362*^9}, {3.643559050529228*^9, 3.643559067615406*^9}, {
   3.64355916554055*^9, 3.64355919381754*^9}, {3.643559264526951*^9, 
   3.643559276365679*^9}, {3.643559545095036*^9, 3.6435595535582743`*^9}, {
   3.643559602033443*^9, 3.643559611558193*^9}, {3.643560031489501*^9, 
   3.6435600520230207`*^9}, {3.643990438115991*^9, 3.6439905057761307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"A", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["A", "2"]}]], " ", "B", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["B", "2"]}]]}], "-", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["A", "2"], "-", 
        SuperscriptBox["A", "4"]}]], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["B", "2"], "-", 
        SuperscriptBox["B", "4"]}]]}]}], ")"}], " ", "x", " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "A"}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["A", "2"]}]], " ", "B", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["B", "2"]}]]}], "+", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["A", "2"], "-", 
        SuperscriptBox["A", "4"]}]], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["B", "2"], "-", 
        SuperscriptBox["B", "4"]}]]}]}], ")"}], " ", "x", " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]]}], "-", 
  RowBox[{"a", " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["a", "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["A", "2"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["B", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "2"]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.643559611948723*^9, {3.6435600459018393`*^9, 3.643560056459041*^9}, 
   3.643989923316527*^9, 3.643990506264226*^9, 3.643992403628989*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "x", ",", "y", ",", "Init1", ",", "Init2", ",", "Init3", ",", 
    "FinalSt", ",", "mkvec", ",", "Measure", ",", "RMeasure", ",", "NEntropy",
     ",", "A", ",", "Init"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mkvec", "[", 
    RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "a1", "]"}], 
       RowBox[{"Sin", "[", "a2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "a1", "]"}], 
       RowBox[{"Cos", "[", "a2", "]"}], 
       RowBox[{"Sin", "[", "a3", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "a1", "]"}], 
       RowBox[{"Cos", "[", "a2", "]"}], 
       RowBox[{"Cos", "[", "a3", "]"}]}], ",", 
      RowBox[{"Cos", "[", "a1", "]"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sbell1", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"a", ",", "0", ",", "0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sbell2", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", "0", ",", "0", ",", 
      RowBox[{"-", "a"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sbell3", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "a", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sbell4", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"a", "^", "2"}]}], "]"}], ",", 
      RowBox[{"-", "a"}], ",", "0"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Measure", "[", 
    RowBox[{"v1_", ",", "v2_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "v1", "]"}], ".", "v1"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "v2", "]"}], ".", "v2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RMeasure", "[", 
    RowBox[{"v1_", ",", "v2_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "4", "]"}], "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "v1", "]"}], ".", "v1"}], "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "v2", "]"}], ".", "v2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FinalSt", "[", 
    RowBox[{"init_", ",", "M1_", ",", "M2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", "M2"}], "]"}], ".", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"M1", ",", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "]"}], ".", "init"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Entropy_vec", "[", "v_", "]"}], ":=", " ", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "v", "}"}], "]"}], ".", 
      RowBox[{"{", "v", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogA", "[", "a_", "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"a", "\[Equal]", "0"}], ",", "0", ",", 
     RowBox[{"Log2", "[", "a", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NEntropy", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"LogA", "[", "a", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "a"}], ")"}], 
       RowBox[{"LogA", "[", 
        RowBox[{"1", "-", "a"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Optm", "[", 
   RowBox[{
   "init1_", ",", "init2_", ",", "init3_", ",", "init4_", ",", "u1_", ",", 
    "u2_", ",", "v1_", ",", "v2_", ",", "x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "4"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"Measure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"Measure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init1"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"Measure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"Measure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init2"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"Measure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"Measure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init3"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"Measure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"Measure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init4"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"RMeasure", "[", 
          RowBox[{"mkvec", "[", 
           RowBox[{"v1", ",", "v2"}], "]"}], "]"}], ",", 
         RowBox[{"RMeasure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init1"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"RMeasure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"RMeasure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init2"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"RMeasure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"RMeasure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init3"}], "]"}], "]"}], "+", 
      RowBox[{"Norm", "[", 
       RowBox[{"FinalSt", "[", 
        RowBox[{
         RowBox[{"RMeasure", "[", 
          RowBox[{"v1", ",", "v2"}], "]"}], ",", 
         RowBox[{"RMeasure", "[", 
          RowBox[{"u1", ",", "u2"}], "]"}], ",", "init4"}], "]"}], "]"}]}], 
     ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NEntropy", "[", 
       RowBox[{"x", "^", "2"}], "]"}], "-", "1"}], ")"}]}], " ", "+", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Init", "[", 
    RowBox[{"v_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"permket", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"v", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "0", ",", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{"x", "^", "2"}]}], "]"}]}], "}"}], "}"}]}], "]"}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{"FinalSt", "[", 
     RowBox[{
      RowBox[{"Init", "[", 
       RowBox[{
        RowBox[{"Sbell4", "[", "a", "]"}], ",", "x"}], "]"}], ",", 
      RowBox[{"RMeasure", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "A", "]"}], ",", 
        RowBox[{"Psi2", "[", "A", "]"}]}], "]"}], ",", 
      RowBox[{"Measure", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "B", "]"}], ",", 
        RowBox[{"Pri1", "[", "B", "]"}]}], "]"}]}], "]"}], ".", 
    RowBox[{"FinalSt", "[", 
     RowBox[{
      RowBox[{"Init", "[", 
       RowBox[{
        RowBox[{"Sbell1", "[", "a", "]"}], ",", "x"}], "]"}], ",", 
      RowBox[{"RMeasure", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "A", "]"}], ",", 
        RowBox[{"Psi2", "[", "A", "]"}]}], "]"}], ",", 
      RowBox[{"Measure", "[", 
       RowBox[{
        RowBox[{"Phi1", "[", "B", "]"}], ",", 
        RowBox[{"Pri1", "[", "B", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FinalSt", "[", 
  RowBox[{
   RowBox[{"Init", "[", 
    RowBox[{
     RowBox[{"Sbell1", "[", "a", "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"Measure", "[", 
    RowBox[{
     RowBox[{"Phi1", "[", "A", "]"}], ",", 
     RowBox[{"Psi2", "[", "A", "]"}]}], "]"}], ",", 
   RowBox[{"Measure", "[", 
    RowBox[{
     RowBox[{"Phi1", "[", "B", "]"}], ",", 
     RowBox[{"Pri1", "[", "B", "]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{
   RowBox[{"FinalSt", "[", 
    RowBox[{
     RowBox[{"Init", "[", 
      RowBox[{
       RowBox[{"Sbell3", "[", "a", "]"}], ",", "x"}], "]"}], ",", 
     RowBox[{"RMeasure", "[", 
      RowBox[{
       RowBox[{"Phi1", "[", "A", "]"}], ",", 
       RowBox[{"Psi2", "[", "A", "]"}]}], "]"}], ",", 
     RowBox[{"RMeasure", "[", 
      RowBox[{
       RowBox[{"Phi1", "[", "D", "]"}], ",", 
       RowBox[{"Pri1", "[", "D", "]"}]}], "]"}]}], "]"}], ".", 
   RowBox[{"FinalSt", "[", 
    RowBox[{
     RowBox[{"Init", "[", 
      RowBox[{
       RowBox[{"Sbell4", "[", "a", "]"}], ",", "x"}], "]"}], ",", 
     RowBox[{"RMeasure", "[", 
      RowBox[{
       RowBox[{"Phi1", "[", "A", "]"}], ",", 
       RowBox[{"Psi2", "[", "A", "]"}]}], "]"}], ",", 
     RowBox[{"RMeasure", "[", 
      RowBox[{
       RowBox[{"Phi1", "[", "D", "]"}], ",", 
       RowBox[{"Pri1", "[", "D", "]"}]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.643541736907957*^9, {3.6435417778493156`*^9, 3.643541890260982*^9}, {
   3.643542368487236*^9, 3.64354261689143*^9}, {3.6435428975120163`*^9, 
   3.643542909546105*^9}, {3.643542951399226*^9, 3.6435429917953577`*^9}, {
   3.643543083929418*^9, 3.6435431162065563`*^9}, {3.643554648415444*^9, 
   3.643554655622807*^9}, {3.643554716731435*^9, 3.643555067596075*^9}, {
   3.6435553652716923`*^9, 3.6435555357081823`*^9}, {3.6435556184442453`*^9, 
   3.6435556328823977`*^9}, {3.643555779028405*^9, 3.643555833058673*^9}, {
   3.643555879545656*^9, 3.643555998082025*^9}, {3.643556040816773*^9, 
   3.6435560834069757`*^9}, {3.6435561261162567`*^9, 
   3.6435561773862753`*^9}, {3.6435562216964684`*^9, 3.643556242814451*^9}, {
   3.643556278453032*^9, 3.643556291910096*^9}, {3.6435563346035624`*^9, 
   3.643556388840272*^9}, {3.643556563866301*^9, 3.643556565625823*^9}, {
   3.643556734595653*^9, 3.643556816868072*^9}, {3.643558148074956*^9, 
   3.643558166992426*^9}, {3.643558212302012*^9, 3.643558248316024*^9}, {
   3.643558336273155*^9, 3.643558401229348*^9}, {3.643559540551474*^9, 
   3.643559569189829*^9}, {3.643559631581558*^9, 3.643559646260735*^9}, {
   3.643559691700495*^9, 3.643559726660329*^9}, {3.643560000424122*^9, 
   3.643560005905559*^9}, {3.643560126297134*^9, 3.6435601391518393`*^9}, {
   3.64356027429992*^9, 3.643560381327118*^9}, 3.6435604181908903`*^9, {
   3.643560575788382*^9, 3.643560638738371*^9}, {3.643560729813683*^9, 
   3.643560741974558*^9}, {3.643562239130898*^9, 3.6435622604525957`*^9}, {
   3.6439891133324966`*^9, 3.643989179435871*^9}, {3.64398945023283*^9, 
   3.643989481117776*^9}, {3.6439898402125673`*^9, 3.6439899367467537`*^9}, {
   3.6439900004194117`*^9, 3.643990012205985*^9}, {3.643990515048771*^9, 
   3.643990564249402*^9}, 3.6439906963447866`*^9, {3.643990754837802*^9, 
   3.6439907587013407`*^9}, {3.643990844410016*^9, 3.643990848073847*^9}, {
   3.6439912562475843`*^9, 3.64399126623131*^9}, {3.643991389105399*^9, 
   3.6439914078886766`*^9}, {3.643991483349011*^9, 3.6439914926051826`*^9}, {
   3.643991567577443*^9, 3.643991593928475*^9}, {3.64399206628389*^9, 
   3.643992250346838*^9}, {3.643992286197125*^9, 3.643992289880888*^9}, {
   3.6439923213166447`*^9, 3.643992321486782*^9}, {3.643992360326515*^9, 
   3.643992386139949*^9}, {3.64399269722078*^9, 3.6439927174099617`*^9}, {
   3.643993593153775*^9, 3.643993594504661*^9}, 3.643993630309099*^9, {
   3.643993977303315*^9, 3.6439939922711143`*^9}, {3.643994056036242*^9, 
   3.643994056586673*^9}, {3.643994269256324*^9, 3.643994269352056*^9}, {
   3.643994313225121*^9, 3.6439943134943333`*^9}, 3.6439944158844767`*^9, 
   3.643994678154924*^9, {3.643994869160149*^9, 3.6439948730229588`*^9}, {
   3.643994942277357*^9, 3.643994944021077*^9}, 3.643995290357903*^9, {
   3.643995816879364*^9, 3.643995830229775*^9}, {3.643996180311952*^9, 
   3.643996203574894*^9}, {3.6439963840465927`*^9, 3.6439964035499983`*^9}, {
   3.6439964535000563`*^9, 3.643996476131237*^9}, {3.643996646459996*^9, 
   3.6439966735945187`*^9}, {3.6439967314152308`*^9, 3.643996766189851*^9}, 
   3.64399688268106*^9, 3.64399692359096*^9, {3.643996957541792*^9, 
   3.643996976691923*^9}, {3.643997301318982*^9, 3.643997308317869*^9}, {
   3.643998651909628*^9, 3.64399868856279*^9}, 3.643998728106385*^9, {
   3.643998853947413*^9, 3.643998857186619*^9}, {3.6439990880188713`*^9, 
   3.643999092737672*^9}, {3.643999127856278*^9, 3.643999153479493*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.64355964683127*^9, 3.643559727242058*^9, 3.643560006579764*^9, 
   3.6435600595556087`*^9, {3.643560127945282*^9, 3.643560139675318*^9}, 
   3.6435604273701553`*^9, {3.643560601112113*^9, 3.643560638976906*^9}, {
   3.6435607305690193`*^9, 3.6435607428681793`*^9}, {3.643562242969494*^9, 
   3.6435622614705887`*^9}, {3.64398988985599*^9, 3.643989937543611*^9}, {
   3.643990002810774*^9, 3.643990012542955*^9}, 3.643990596442512*^9, 
   3.6439906966610737`*^9, 3.6439907632820253`*^9, 3.6439908490305767`*^9, {
   3.643991256600196*^9, 3.6439912666892023`*^9}, {3.643991396331623*^9, 
   3.6439914090929537`*^9}, {3.64399148630427*^9, 3.6439914930619307`*^9}, {
   3.643991572381545*^9, 3.6439915944884567`*^9}, {3.643992113366983*^9, 
   3.643992175381481*^9}, {3.6439923883342667`*^9, 3.643992405487355*^9}, {
   3.64399269776005*^9, 3.64399271851228*^9}, 3.643993598713511*^9, 
   3.643993630584861*^9, {3.643993978059325*^9, 3.6439939931643257`*^9}, 
   3.6439940572106133`*^9, 3.643994272990341*^9, 3.6439943144088*^9, 
   3.643994416619891*^9, 3.6439946796180964`*^9, 3.643994873606132*^9, 
   3.643994944731698*^9, 3.643995290763823*^9, 3.64399583100447*^9, {
   3.643996180876153*^9, 3.6439962041539307`*^9}, 3.6439964045306473`*^9, {
   3.6439964536966467`*^9, 3.643996476372456*^9}, {3.6439966468168707`*^9, 
   3.643996674016838*^9}, 3.643996734013112*^9, {3.64399686292566*^9, 
   3.643996883118957*^9}, 3.6439969239298763`*^9, {3.6439969676235447`*^9, 
   3.643996977039208*^9}, {3.6439973048056602`*^9, 3.643997308672833*^9}, 
   3.643998688883679*^9, 3.643998728808374*^9, 3.643998788691119*^9, 
   3.643998857599069*^9, 3.643999093730191*^9, {3.643999133736979*^9, 
   3.643999153803123*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["A", "2"], " ", 
     SuperscriptBox["B", "2"], " ", "x"}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["a", "2"]}]], " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", "0", ",", "0", ",", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["A", "2"], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", "x"}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["a", "2"]}]], " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", "0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["a", "2"]}]]}], " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", "x"}], "+", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["a", "2"]}]]}], " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", 
     SuperscriptBox["B", "2"], " ", "x"}], "+", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}], ")"}], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", "0", ",", "0", ",", 
   RowBox[{
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["a", "2"]}]], " ", 
     SuperscriptBox["A", "2"], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", "x"}], "-", 
    RowBox[{"a", " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", 
   RowBox[{
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["a", "2"]}]], " ", 
     SuperscriptBox["A", "2"], " ", 
     SuperscriptBox["B", "2"], " ", "x"}], "-", 
    RowBox[{"a", " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"a", " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", 
     SuperscriptBox["B", "2"], " ", "x"}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["a", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}], ")"}], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}], ",", "0", ",", "0", ",", 
   RowBox[{
    RowBox[{"a", " ", "A", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}]], " ", "B", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}]], " ", "x"}], "+", 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["a", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["A", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["B", "2"]}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.64355964683127*^9, 3.643559727242058*^9, 3.643560006579764*^9, 
   3.6435600595556087`*^9, {3.643560127945282*^9, 3.643560139675318*^9}, 
   3.6435604273701553`*^9, {3.643560601112113*^9, 3.643560638976906*^9}, {
   3.6435607305690193`*^9, 3.6435607428681793`*^9}, {3.643562242969494*^9, 
   3.6435622614705887`*^9}, {3.64398988985599*^9, 3.643989937543611*^9}, {
   3.643990002810774*^9, 3.643990012542955*^9}, 3.643990596442512*^9, 
   3.6439906966610737`*^9, 3.6439907632820253`*^9, 3.6439908490305767`*^9, {
   3.643991256600196*^9, 3.6439912666892023`*^9}, {3.643991396331623*^9, 
   3.6439914090929537`*^9}, {3.64399148630427*^9, 3.6439914930619307`*^9}, {
   3.643991572381545*^9, 3.6439915944884567`*^9}, {3.643992113366983*^9, 
   3.643992175381481*^9}, {3.6439923883342667`*^9, 3.643992405487355*^9}, {
   3.64399269776005*^9, 3.64399271851228*^9}, 3.643993598713511*^9, 
   3.643993630584861*^9, {3.643993978059325*^9, 3.6439939931643257`*^9}, 
   3.6439940572106133`*^9, 3.643994272990341*^9, 3.6439943144088*^9, 
   3.643994416619891*^9, 3.6439946796180964`*^9, 3.643994873606132*^9, 
   3.643994944731698*^9, 3.643995290763823*^9, 3.64399583100447*^9, {
   3.643996180876153*^9, 3.6439962041539307`*^9}, 3.6439964045306473`*^9, {
   3.6439964536966467`*^9, 3.643996476372456*^9}, {3.6439966468168707`*^9, 
   3.643996674016838*^9}, 3.643996734013112*^9, {3.64399686292566*^9, 
   3.643996883118957*^9}, 3.6439969239298763`*^9, {3.6439969676235447`*^9, 
   3.643996977039208*^9}, {3.6439973048056602`*^9, 3.643997308672833*^9}, 
   3.643998688883679*^9, 3.643998728808374*^9, 3.643998788691119*^9, 
   3.643998857599069*^9, 3.643999093730191*^9, {3.643999133736979*^9, 
   3.643999153810093*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.64355964683127*^9, 3.643559727242058*^9, 3.643560006579764*^9, 
   3.6435600595556087`*^9, {3.643560127945282*^9, 3.643560139675318*^9}, 
   3.6435604273701553`*^9, {3.643560601112113*^9, 3.643560638976906*^9}, {
   3.6435607305690193`*^9, 3.6435607428681793`*^9}, {3.643562242969494*^9, 
   3.6435622614705887`*^9}, {3.64398988985599*^9, 3.643989937543611*^9}, {
   3.643990002810774*^9, 3.643990012542955*^9}, 3.643990596442512*^9, 
   3.6439906966610737`*^9, 3.6439907632820253`*^9, 3.6439908490305767`*^9, {
   3.643991256600196*^9, 3.6439912666892023`*^9}, {3.643991396331623*^9, 
   3.6439914090929537`*^9}, {3.64399148630427*^9, 3.6439914930619307`*^9}, {
   3.643991572381545*^9, 3.6439915944884567`*^9}, {3.643992113366983*^9, 
   3.643992175381481*^9}, {3.6439923883342667`*^9, 3.643992405487355*^9}, {
   3.64399269776005*^9, 3.64399271851228*^9}, 3.643993598713511*^9, 
   3.643993630584861*^9, {3.643993978059325*^9, 3.6439939931643257`*^9}, 
   3.6439940572106133`*^9, 3.643994272990341*^9, 3.6439943144088*^9, 
   3.643994416619891*^9, 3.6439946796180964`*^9, 3.643994873606132*^9, 
   3.643994944731698*^9, 3.643995290763823*^9, 3.64399583100447*^9, {
   3.643996180876153*^9, 3.6439962041539307`*^9}, 3.6439964045306473`*^9, {
   3.6439964536966467`*^9, 3.643996476372456*^9}, {3.6439966468168707`*^9, 
   3.643996674016838*^9}, 3.643996734013112*^9, {3.64399686292566*^9, 
   3.643996883118957*^9}, 3.6439969239298763`*^9, {3.6439969676235447`*^9, 
   3.643996977039208*^9}, {3.6439973048056602`*^9, 3.643997308672833*^9}, 
   3.643998688883679*^9, 3.643998728808374*^9, 3.643998788691119*^9, 
   3.643998857599069*^9, 3.643999093730191*^9, {3.643999133736979*^9, 
   3.643999153814034*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"a", ",", "x", ",", "y", ",", "A", ",", "B"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SQ", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"x", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Optm1", "[", 
    RowBox[{
     RowBox[{"A_", "?", "NumericQ"}], ",", 
     RowBox[{"B_", "?", "NumericQ"}], ",", 
     RowBox[{"C_", "?", "NumericQ"}], ",", 
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"a_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "A", " ", "B", " ", "x"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"SQ", "[", "A", "]"}], " ", 
        RowBox[{"SQ", "[", "C", "]"}], " ", "x"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"SQ", "[", "a", "]"}], 
        RowBox[{"SQ", "[", "A", "]"}], 
        RowBox[{"SQ", "[", "B", "]"}], 
        RowBox[{"SQ", "[", "x", "]"}]}], "+", 
       RowBox[{
        RowBox[{"SQ", "[", "a", "]"}], "A", " ", "C", " ", 
        RowBox[{"SQ", "[", "x", "]"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NEntropy", "[", 
        RowBox[{"x", "^", "2"}], "]"}], "-", "1"}], ")"}]}], " ", "+", " ", 
    "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindMinimum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"Optm1", "[", 
       RowBox[{"A", ",", "B", ",", "C", ",", "x", ",", "a"}], "]"}], "]"}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"A", " ", "B", " ", 
        RowBox[{"SQ", "[", "a", "]"}], " ", "x"}], " ", "\[Equal]", " ", 
       RowBox[{
        RowBox[{"SQ", "[", "A", "]"}], 
        RowBox[{"SQ", "[", "B", "]"}], "a", " ", 
        RowBox[{"SQ", "[", "x", "]"}]}]}], "&&", " ", 
      RowBox[{
       RowBox[{"A", " ", "C", " ", "a", " ", 
        RowBox[{"SQ", "[", "x", "]"}]}], "\[Equal]", " ", 
       RowBox[{
        RowBox[{"SQ", "[", "A", "]"}], 
        RowBox[{"SQ", "[", "B", "]"}], 
        RowBox[{"SQ", "[", "a", "]"}], "x"}]}], "&&", " ", 
      RowBox[{"0", "\[LessEqual]", "A", "\[LessEqual]", "1"}], "&&", " ", 
      RowBox[{"0", "\[LessEqual]", "B", "\[LessEqual]", "1"}], "&&", " ", 
      RowBox[{"0", "\[LessEqual]", "C", "\[LessEqual]", "1"}], "&&", 
      RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"A", ",", "B", ",", "C", ",", "x"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NEntropy", "[", "0.25", "]"}]}], "Input",
 CellChangeTimes->{{3.643997849392415*^9, 3.643997929818101*^9}, {
  3.643998094872707*^9, 3.643998568768649*^9}, {3.643998738687832*^9, 
  3.643998817377626*^9}, {3.643998864219805*^9, 3.643998879202002*^9}, {
  3.643998984021937*^9, 3.643998985836644*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6405518806077957`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "0.7790420634162217`"}], ",", 
     RowBox[{"B", "\[Rule]", "0.8403019357907457`"}], ",", 
     RowBox[{"C", "\[Rule]", "0.22653076874130798`"}], ",", 
     RowBox[{"x", "\[Rule]", "0.28714406064062636`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6439988762421*^9, 3.64399887965703*^9}, 
   3.643998986644711*^9}],

Cell[BoxData["0.8112781244591328`"], "Output",
 CellChangeTimes->{{3.6439988762421*^9, 3.64399887965703*^9}, 
   3.643998986647952*^9}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 117}, {37, Automatic}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 439, 11, 63, "Input"],
Cell[1022, 35, 555, 11, 24, "Message"],
Cell[1580, 48, 596, 11, 24, "Message"],
Cell[2179, 61, 557, 11, 24, "Message"],
Cell[2739, 74, 594, 11, 24, "Message"],
Cell[3336, 87, 728, 13, 24, "Message"],
Cell[4067, 102, 752, 13, 24, "Message"],
Cell[4822, 117, 598, 11, 24, "Message"],
Cell[5423, 130, 483, 12, 22, "Print"]
}, Open  ]],
Cell[5921, 145, 469, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[6415, 158, 8869, 238, 318, "Input"],
Cell[15287, 398, 1963, 70, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17287, 473, 13632, 348, 369, "Input"],
Cell[30922, 823, 1762, 25, 28, "Output"],
Cell[32687, 850, 6211, 181, 78, "Output"],
Cell[38901, 1033, 1762, 25, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40700, 1063, 2978, 77, 114, "Input"],
Cell[43681, 1142, 454, 11, 28, "Output"],
Cell[44138, 1155, 135, 2, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
