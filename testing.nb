(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     50808,       1163]
NotebookOptionsPosition[     50099,       1136]
NotebookOutlinePosition[     50475,       1152]
CellTagsIndexPosition[     50432,       1149]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "qi.m"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/VBOwkFV4bVjC8dPTxC9KdzBH0S7iXMkguh5Dyal
gui/x/elg+j4qIQcsLqdnR0gWiOGbR6IXqZ2ajmInu4nsQtEhzG6HAPRiZpW
V0C0l73oAxA9gVFvvTWQ7ps2DUyLuQtuAdFcIqt2gehVkxQOgmjfPN4XIPpG
ifBbEM2g+P4DiN5ie+QLiF7S9ewHiA76IfcPREddOsBhA6SZIsQFQfQtj+dK
IHrOiuMaILotxVATRLvs/KIPoqfysgSD6J4/E7tAdMSWRTNAdIDzq6xpIPE8
zVwQHRDz6NR0IF0k9uo0iH6U8557F5B+cFGKB0T7fpaz2QOk+Xi0wTQATleR
sA==
  "]],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package QI version \"\>", 
   "\[InvisibleSpace]", "\<\"0.4.37\"\>", 
   "\[InvisibleSpace]", "\<\" (last modification: \"\>", 
   "\[InvisibleSpace]", "\<\"21/12/2012\"\>", 
   "\[InvisibleSpace]", "\<\").\"\>"}],
  SequenceForm[
  "Package QI version ", "0.4.37", " (last modification: ", "21/12/2012", 
   ")."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6411268644462814`*^9, 3.6411270055953293`*^9, 3.641127254571167*^9, 
   3.6411314463276715`*^9, {3.641138696748372*^9, 3.641138699492529*^9}, 
   3.641142688291675*^9, 3.6411443140886655`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6407332727613726`*^9, 3.640733308650425*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", " ", "pos1_", ",", " ", "pos2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", " ", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"TraceSystem", "[", 
   RowBox[{"D_", ",", " ", "s_"}], "]"}], ":=", " ", 
  RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Qubits", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"z", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"q", "=", "1"}], ",", 
      RowBox[{"q", "<", "z"}], ",", 
      RowBox[{"q", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Log", "[", 
         RowBox[{"2", ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        RowBox[{"Qubits", "[", 
         RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", "\[Equal]", "n"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TrkM", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"p", "=", "1"}], ",", 
            RowBox[{"p", "<", 
             RowBox[{
              SuperscriptBox["2", "n"], "+", "1"}]}], ",", 
            RowBox[{"p", "=", 
             RowBox[{"p", "+", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"TrkM", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"TrkM", ",", 
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{
                   RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["2", "n"], ",", "2"}], "}"}]}], "]"}], "+", 
                 RowBox[{"Take", "[", 
                  RowBox[{
                   RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", 
                    SuperscriptBox["2", "n"], ",", "2"}], "}"}]}], "]"}]}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", " ", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "0"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"(", 
              RowBox[{"n", "-", "k"}], ")"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"b", "=", 
              RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 SuperscriptBox["2", "n"], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "==", "1"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{"b", ",", " ", "i"}], "]"}], "  ", "\[Equal]", 
                   "0"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"Permut", "=", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", " ", "n"}], "]"}],
                     ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"b", "=", 
                   RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", " ", "n"}], "]"}],
                     ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"c", "=", 
                   RowBox[{"Range", "[", 
                    SuperscriptBox["2", "n"], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"perm", "=", 
                   RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", " ", "n"}], "]"}],
                     ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"M", "=", 
                   RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "\[IndentingNewLine]", " ", "]"}]}], 
              "    ", "\[IndentingNewLine]", "]"}], "         ", ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TrkM", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"p", "=", "1"}], ",", 
               RowBox[{"p", "<", 
                RowBox[{
                 SuperscriptBox["2", "n"], "+", "1"}]}], ",", 
               RowBox[{"p", "=", 
                RowBox[{"p", "+", "2"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"TrkM", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"TrkM", ",", 
                   RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    SuperscriptBox["2", "n"], ",", "2"}], "}"}]}], "]"}], "+", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    SuperscriptBox["2", "n"], ",", "2"}], "}"}]}], "]"}]}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "   ", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ";", 
    RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6409555667115173`*^9, 3.640955573372898*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Log1", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "==", "0"}], ",", "0", ",", 
     RowBox[{"Log", "[", "x", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixLog", "[", "X_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ss", ",", "S", ",", "IS", ",", "eigenV", ",", "eigenVmat"}], 
     "}"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ss", "=", 
       RowBox[{"Eigenvectors", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Transpose", "[", "ss", "]"}]}], ";", 
      RowBox[{"IS", "=", 
       RowBox[{"Inverse", "[", "S", "]"}]}], ";", 
      RowBox[{"eigenV", "=", 
       RowBox[{"Eigenvalues", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eigenVmat", "=", 
       RowBox[{"DiagonalMatrix", "[", "eigenV", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "[", "eigenV", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"eigenVmat", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Log1", "[", 
          RowBox[{"Re", "[", 
           RowBox[{"eigenV", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Diagonal", "[", "eigenVmat", "]"}], "]"}], ".", "IS"}]}], 
     ")"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.640950935428275*^9, 3.640950971914215*^9}, {
   3.6409511029184256`*^9, 3.640951121457486*^9}, {3.6409511551264477`*^9, 
   3.64095128627868*^9}, {3.6409513516109953`*^9, 3.6409514389851503`*^9}, {
   3.640951477278618*^9, 3.640951610173053*^9}, {3.6409516941627846`*^9, 
   3.6409517300438375`*^9}, {3.640951950555531*^9, 3.640952006166936*^9}, {
   3.6409520473474083`*^9, 3.640952138004569*^9}, {3.6409529268615265`*^9, 
   3.6409530343846765`*^9}, {3.640953067072546*^9, 3.640953087576719*^9}, {
   3.6409531768658257`*^9, 3.6409531850682945`*^9}, {3.64095347153568*^9, 
   3.6409535817729855`*^9}, {3.640953619020116*^9, 3.6409536248414483`*^9}, {
   3.6409536722171583`*^9, 3.640953705597068*^9}, {3.640953749646587*^9, 
   3.640953770303768*^9}, {3.6409538129812098`*^9, 3.6409539406455116`*^9}, {
   3.6409541796321807`*^9, 3.6409542422747636`*^9}, {3.6409543083025403`*^9, 
   3.6409543113527145`*^9}, {3.640954352393062*^9, 3.640954482031477*^9}, {
   3.6409546125229406`*^9, 3.6409548247930818`*^9}, {3.6409549033035727`*^9, 
   3.640954956780631*^9}, {3.6409550014921885`*^9, 3.6409551580461426`*^9}, {
   3.640955231029317*^9, 3.640955232183383*^9}, {3.640955273826765*^9, 
   3.640955274156784*^9}, {3.640955480584591*^9, 3.640955481324633*^9}, {
   3.640955519613823*^9, 3.640955596256207*^9}, {3.640962458728718*^9, 
   3.640962463432987*^9}, {3.640962561243582*^9, 3.6409626959612865`*^9}, {
   3.640962779052039*^9, 3.6409627797790813`*^9}, {3.640962811290883*^9, 
   3.6409629729761314`*^9}, {3.640970750199963*^9, 3.640970754051183*^9}, {
   3.6409721685590887`*^9, 3.6409722103544793`*^9}, {3.6409740019749537`*^9, 
   3.6409740146626797`*^9}, {3.640974192003823*^9, 3.6409742239796515`*^9}, {
   3.6409742898874216`*^9, 3.640974327659582*^9}, {3.640974384482832*^9, 
   3.6409744109843483`*^9}, 3.640974447892459*^9, {3.6409745347284255`*^9, 
   3.6409746024272976`*^9}, {3.6409746629497595`*^9, 
   3.6409747117795525`*^9}, {3.6409747462395234`*^9, 3.640974773661092*^9}, {
   3.6409750781355066`*^9, 3.6409751763171225`*^9}, {3.6409752937258377`*^9, 
   3.6409752939178486`*^9}, {3.640975366009972*^9, 3.640975367174039*^9}, {
   3.6409754373650537`*^9, 3.6409754418893127`*^9}, {3.6409754784174013`*^9, 
   3.6409754787854223`*^9}, {3.641131610831081*^9, 3.641131614059265*^9}, {
   3.6411316539235454`*^9, 3.6411316570917263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"comp", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", " ", 
     RowBox[{"x", " ", "+", 
      RowBox[{"I", " ", "y"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mkvec2", "[", 
      RowBox[{
      "x01_", ",", "x02_", ",", "x03_", ",", "x04_", ",", "y01_", ",", "y02_",
        ",", "y03_", ",", "y04_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"comp", "[", 
          RowBox[{"x01", ",", "y01"}], "]"}], ",", 
         RowBox[{"comp", "[", 
          RowBox[{"x02", ",", "y02"}], "]"}], ",", 
         RowBox[{"comp", "[", 
          RowBox[{"x03", ",", "y03"}], "]"}], ",", 
         RowBox[{"comp", "[", 
          RowBox[{"x04", ",", "y04"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "phi1"}], " ", "=", " ", 
      RowBox[{"mkvec2", "[", 
       RowBox[{
        RowBox[{"Re", "[", "ar", "]"}], ",", "0", ",", "0", ",", 
        RowBox[{"Re", "[", "br", "]"}], ",", 
        RowBox[{"Re", "[", "ai", "]"}], ",", "0", ",", "0", ",", 
        RowBox[{"Re", "[", "bi", "]"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"phi2", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{
       RowBox[{"Re", "[", "br", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "ar", "]"}]}], ",", 
       RowBox[{"Re", "[", "bi", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "ai", "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"psi1", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Re", "[", "ar", "]"}], ",", 
       RowBox[{"Re", "[", "br", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"Re", "[", "ai", "]"}], ",", 
       RowBox[{"Re", "[", "bi", "]"}], ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"psi2", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Re", "[", "br", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "ar", "]"}]}], ",", "0", ",", "0", ",", 
       RowBox[{"Re", "[", "bi", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "ai", "]"}]}], ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"normphi", " ", "=", " ", 
     RowBox[{"Norm", "[", "phi1", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Phi1", " ", "=", " ", 
       RowBox[{"mkvec2", "[", 
        RowBox[{
         RowBox[{"Re", "[", "cr", "]"}], ",", "0", ",", "0", ",", 
         RowBox[{"Re", "[", "dr", "]"}], ",", 
         RowBox[{"Re", "[", "ci", "]"}], ",", "0", ",", "0", ",", 
         RowBox[{"Re", "[", "di", "]"}]}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Phi1", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{
       RowBox[{"Re", "[", "x01", "]"}], ",", 
       RowBox[{"Re", "[", "x02", "]"}], ",", 
       RowBox[{"Re", "[", "x03", "]"}], ",", 
       RowBox[{"Re", "[", "x04", "]"}], ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Phi2", " ", "=", " ", 
       RowBox[{"mkvec2", "[", 
        RowBox[{
         RowBox[{"Re", "[", "x01", "]"}], ",", 
         RowBox[{"Re", "[", "x02", "]"}], ",", 
         RowBox[{"Re", "[", "x03", "]"}], ",", 
         RowBox[{"Re", "[", "x04", "]"}], ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Psi1", " ", "=", " ", 
       RowBox[{"mkvec2", "[", 
        RowBox[{
         RowBox[{"Re", "[", "x01", "]"}], ",", 
         RowBox[{"Re", "[", "x02", "]"}], ",", 
         RowBox[{"Re", "[", "x03", "]"}], ",", 
         RowBox[{"Re", "[", "x04", "]"}], ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Psi2", " ", "=", " ", 
       RowBox[{"mkvec2", "[", 
        RowBox[{
         RowBox[{"Re", "[", "x01", "]"}], ",", 
         RowBox[{"Re", "[", "x02", "]"}], ",", 
         RowBox[{"Re", "[", "x03", "]"}], ",", 
         RowBox[{"Re", "[", "x04", "]"}], ",", "0", ",", "0", ",", "0", ",", 
         "0"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Phi2", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{
       RowBox[{"Re", "[", "dr", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "cr", "]"}]}], ",", 
       RowBox[{"Re", "[", "di", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "ci", "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Psi1", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Re", "[", "cr", "]"}], ",", 
       RowBox[{"Re", "[", "dr", "]"}], ",", "0", ",", "0", ",", 
       RowBox[{"Re", "[", "ci", "]"}], ",", 
       RowBox[{"Re", "[", "di", "]"}], ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Psi2", " ", "=", " ", 
     RowBox[{"mkvec2", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Re", "[", "dr", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "cr", "]"}]}], ",", "0", ",", "0", ",", 
       RowBox[{"Re", "[", "di", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Re", "[", "ci", "]"}]}], ",", "0"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ar", " ", "=", " ", 
     RowBox[{"br", " ", "=", " ", 
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"bi", " ", "=", " ", 
     RowBox[{"ai", " ", "=", "0"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"cr", " ", "=", " ", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ci", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dr", " ", "=", " ", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"di", " ", "=", " ", "0"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"normPhi", " ", "=", " ", 
     RowBox[{"Expand", "[", 
      RowBox[{"Norm", "[", "Phi1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"finvec", " ", "=", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"{", "phi1", "}"}], ",", 
          RowBox[{"{", "Phi1", "}"}]}], "]"}], " ", "+", " ", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"{", "phi2", "}"}], ",", 
          RowBox[{"{", "Phi2", "}"}]}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"{", "psi1", "}"}], ",", 
          RowBox[{"{", "Psi1", "}"}]}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"{", "psi2", "}"}], ",", 
          RowBox[{"{", "Psi2", "}"}]}], "]"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"densmat1", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "finvec", "]"}], ".", "finvec"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pdensmat1", " ", "=", " ", 
     RowBox[{"PartialTrace", "[", 
      RowBox[{"densmat1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"einitial", " ", "=", " ", 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{"MatrixLog", "[", "pdensmat1", "]"}], ".", "pdensmat1"}]}], 
        "]"}], "/", 
       RowBox[{"Log", "[", "2", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"einitial", " ", "=", "  ", 
       RowBox[{"Entropy", "[", 
        RowBox[{"QuantumEntropy", "[", "pdensmat1", "]"}], "]"}]}], ";"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"densmat2", " ", "=", " ", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"{", "phi1", "}"}], "]"}], ".", 
      RowBox[{"{", "phi1", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pdensmat2", " ", "=", " ", 
     RowBox[{"Expand", "[", 
      RowBox[{"PartialTrace", "[", 
       RowBox[{"densmat2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"efinal", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{
           RowBox[{"Tr", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"MatrixLog", "[", "pdensmat2", "]"}], ".", 
              "pdensmat2"}]}], "]"}], "/", 
           RowBox[{"Log", "[", "2", "]"}]}], "]"}], "\[IndentingNewLine]", 
         "efinal"}], "-", "einitial"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"efinal", " ", "=", " ", 
       RowBox[{"Entropy", "[", 
        RowBox[{"QuantumEntropy", "[", "pdensmat2", "]"}], "]"}]}], ";"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"FindMaximum", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"efinal", " ", "-", " ", "einitial"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"cr", "^", "2"}], "+", 
           RowBox[{"dr", "^", "2"}], "+", 
           RowBox[{"ci", "^", "2"}], "+", 
           RowBox[{"di", "^", "2"}]}], "==", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x01", "^", "2"}], "+", 
           RowBox[{"x02", "^", "2"}], "+", 
           RowBox[{"x03", "^", "2"}], "+", 
           RowBox[{"x04", "^", "2"}]}], "\[Equal]", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "dr", ",", "cr", ",", "ci", ",", "di", ",", "x01", ",", "x02", ",", 
         "x03", ",", "x04"}], "}"}]}], "]"}], "*)"}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ar", "=", "0.4"}], ",", 
        RowBox[{"ar", "<", "1"}], ",", 
        RowBox[{"ar", " ", "=", " ", 
         RowBox[{"ar", "+", "0.5"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Maximize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"efinal", "-", "einitial"}], ",", 
             RowBox[{
              RowBox[{"normPhi", "\[Equal]", "1"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"ar", "^", "2"}], "+", 
                RowBox[{"br", "^", "2"}]}], "\[Equal]", "1"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04", ",", "br"}], 
            "}"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "ar", ",", "br", ",", "ai", ",", "bi", ",", "cr", ",", "dr", ",", "ci", 
      ",", "di"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Minimize", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.640950935428275*^9, 3.640950971914215*^9}, {
   3.6409511029184256`*^9, 3.640951121457486*^9}, {3.6409511551264477`*^9, 
   3.64095128627868*^9}, {3.6409513516109953`*^9, 3.6409514389851503`*^9}, {
   3.640951477278618*^9, 3.640951610173053*^9}, {3.6409516941627846`*^9, 
   3.6409517300438375`*^9}, {3.640951950555531*^9, 3.640952006166936*^9}, {
   3.6409520473474083`*^9, 3.640952138004569*^9}, {3.6409529268615265`*^9, 
   3.6409530343846765`*^9}, {3.640953067072546*^9, 3.640953087576719*^9}, {
   3.6409531768658257`*^9, 3.6409531850682945`*^9}, {3.64095347153568*^9, 
   3.6409535817729855`*^9}, {3.640953619020116*^9, 3.6409536248414483`*^9}, {
   3.6409536722171583`*^9, 3.640953705597068*^9}, {3.640953749646587*^9, 
   3.640953770303768*^9}, {3.6409538129812098`*^9, 3.6409539406455116`*^9}, {
   3.6409541796321807`*^9, 3.6409542422747636`*^9}, {3.6409543083025403`*^9, 
   3.6409543113527145`*^9}, {3.640954352393062*^9, 3.640954482031477*^9}, {
   3.6409546125229406`*^9, 3.6409548247930818`*^9}, {3.6409549033035727`*^9, 
   3.640954956780631*^9}, {3.6409550014921885`*^9, 3.6409551580461426`*^9}, {
   3.640955231029317*^9, 3.640955232183383*^9}, {3.640955273826765*^9, 
   3.640955274156784*^9}, {3.640955480584591*^9, 3.640955481324633*^9}, {
   3.640955519613823*^9, 3.640955604610685*^9}, {3.640955667154262*^9, 
   3.640955705094432*^9}, {3.6409557681400385`*^9, 3.640955825812337*^9}, {
   3.6409561470597115`*^9, 3.6409564328510575`*^9}, {3.640956486697137*^9, 
   3.640956489036271*^9}, {3.6409565231192207`*^9, 3.640956578671398*^9}, {
   3.6409568724702024`*^9, 3.6409570274810686`*^9}, 3.640961950713661*^9, {
   3.640962016932449*^9, 3.640962036832587*^9}, {3.640962107449626*^9, 
   3.640962114897052*^9}, {3.6409622208211107`*^9, 3.6409622682748246`*^9}, {
   3.6409624189624434`*^9, 3.640962433428271*^9}, {3.6409629990776243`*^9, 
   3.6409630432931533`*^9}, {3.6409631089789104`*^9, 
   3.6409631385786033`*^9}, {3.6409631798609643`*^9, 
   3.6409631847602444`*^9}, {3.6409632186241817`*^9, 3.64096330409207*^9}, {
   3.6409642840361195`*^9, 3.640964317670043*^9}, {3.640964366022809*^9, 
   3.640964417487753*^9}, {3.6409644707607994`*^9, 3.640964533725401*^9}, {
   3.6409645710965385`*^9, 3.6409647054202213`*^9}, {3.6409647556750956`*^9, 
   3.640964838155813*^9}, {3.640964969134305*^9, 3.6409649972209115`*^9}, {
   3.6409651281944027`*^9, 3.6409651288194385`*^9}, {3.6409655306584225`*^9, 
   3.6409655326565366`*^9}, {3.64096559251396*^9, 3.6409657056694326`*^9}, {
   3.6409658177828445`*^9, 3.640965839133066*^9}, {3.640965990999752*^9, 
   3.6409660406595926`*^9}, {3.6409661392982345`*^9, 3.640966183208746*^9}, 
   3.6409664663469405`*^9, {3.640966801240095*^9, 3.6409668428394747`*^9}, {
   3.6409669240481195`*^9, 3.6409669765701237`*^9}, {3.64096707196358*^9, 
   3.6409671716452813`*^9}, {3.6409672248233232`*^9, 3.640967280440504*^9}, {
   3.640967312400332*^9, 3.6409673241430035`*^9}, {3.640967355235782*^9, 
   3.640967363161236*^9}, {3.6409673960681176`*^9, 3.6409677120631914`*^9}, {
   3.6409677501023674`*^9, 3.6409677564387293`*^9}, {3.6409678332081203`*^9, 
   3.6409678871222043`*^9}, {3.6409679852368164`*^9, 
   3.6409679918141923`*^9}, {3.6409680277402472`*^9, 
   3.6409680408949995`*^9}, {3.640968305987162*^9, 3.6409683716539183`*^9}, {
   3.640968632685848*^9, 3.640968709983269*^9}, {3.6409688493452406`*^9, 
   3.6409688835121946`*^9}, {3.640968939342388*^9, 3.64096900703726*^9}, {
   3.6409690568071065`*^9, 3.640969089480975*^9}, {3.640969129459262*^9, 
   3.6409691755318975`*^9}, {3.6409692583206325`*^9, 3.640969288947384*^9}, {
   3.6409693321388545`*^9, 3.640969367577882*^9}, {3.6409693996667166`*^9, 
   3.640969415030596*^9}, {3.640969449945593*^9, 3.6409694553959045`*^9}, {
   3.6409694961172333`*^9, 3.64096954605809*^9}, {3.6409696074326005`*^9, 
   3.6409696595655823`*^9}, {3.6409697000949*^9, 3.640969730104617*^9}, {
   3.6409697811005335`*^9, 3.6409698991792874`*^9}, {3.640969948726121*^9, 
   3.640970060909538*^9}, {3.6409700975856357`*^9, 3.6409701282703905`*^9}, 
   3.6409701927330775`*^9, {3.640970267334345*^9, 3.6409703289398685`*^9}, {
   3.640970370335236*^9, 3.640970378460701*^9}, 3.640970421964189*^9, {
   3.640970594822076*^9, 3.6409706184874296`*^9}, {3.640970685790279*^9, 
   3.640970687311366*^9}, {3.6409708232551413`*^9, 3.640970862199369*^9}, {
   3.6409709002705464`*^9, 3.640970991695776*^9}, {3.6409716544716845`*^9, 
   3.6409716938239355`*^9}, {3.6409717398785696`*^9, 3.640971749343111*^9}, {
   3.6409717989949503`*^9, 3.640971863126619*^9}, 3.640971926319233*^9, {
   3.640971980745346*^9, 3.640972107444593*^9}, {3.6409722160898075`*^9, 
   3.6409723110362377`*^9}, {3.640972350267482*^9, 3.640972356684849*^9}, {
   3.6409724240116997`*^9, 3.6409724518222904`*^9}, {3.640972586858014*^9, 
   3.640972604603029*^9}, {3.640972656287985*^9, 3.64097265689902*^9}, {
   3.6409726970723176`*^9, 3.640972699790473*^9}, 3.6409727374936295`*^9, 
   3.640972781396141*^9, {3.6409728148900566`*^9, 3.6409728757845397`*^9}, {
   3.6409729234352646`*^9, 3.6409729689008656`*^9}, {3.640973026901183*^9, 
   3.6409730407239733`*^9}, {3.6409731158442698`*^9, 3.640973208350561*^9}, {
   3.6409732755474043`*^9, 3.6409734741297626`*^9}, {3.640973510598849*^9, 
   3.6409735160551605`*^9}, {3.640973589678372*^9, 3.6409735935545936`*^9}, {
   3.640973627275522*^9, 3.6409737578849926`*^9}, {3.6409738472701054`*^9, 
   3.6409738980300083`*^9}, {3.6409739347041063`*^9, 
   3.6409739353741446`*^9}, {3.640973981882805*^9, 3.640973993110447*^9}, {
   3.640974052362836*^9, 3.6409740659026103`*^9}, {3.6409741383307533`*^9, 
   3.6409741746038275`*^9}, {3.6409744798962893`*^9, 3.640974483488495*^9}, 
   3.6409745489432387`*^9, 3.640974590160596*^9, {3.640974827888193*^9, 
   3.640974829818304*^9}, {3.6409749892084208`*^9, 3.640975053174079*^9}, {
   3.6409751949951906`*^9, 3.640975264813184*^9}, {3.6409753229205074`*^9, 
   3.6409753438987074`*^9}, {3.6409753857381005`*^9, 
   3.6409753951196375`*^9}, {3.640975453002948*^9, 3.6409755320134673`*^9}, {
   3.640975562168192*^9, 3.640975638295546*^9}, {3.6409759268470507`*^9, 
   3.6409759567657614`*^9}, {3.6410369734985037`*^9, 3.641037035306039*^9}, {
   3.6410371054570513`*^9, 3.641037287538466*^9}, {3.6410373718872905`*^9, 
   3.641037391615419*^9}, 3.6410376461229753`*^9, {3.641038483949729*^9, 
   3.6410385123053503`*^9}, {3.641038691702612*^9, 3.6410388225000925`*^9}, {
   3.6410388552619667`*^9, 3.6410388714558926`*^9}, {3.64103896021797*^9, 
   3.6410389917407727`*^9}, {3.6410392019557962`*^9, 3.64103920656606*^9}, 
   3.64103925499183*^9, {3.6410396628091555`*^9, 3.6410396856814637`*^9}, {
   3.6410397186473494`*^9, 3.6410397381084623`*^9}, {3.641039791510517*^9, 
   3.6410398379431725`*^9}, {3.6410423961434937`*^9, 
   3.6410424908309093`*^9}, {3.6410425669132605`*^9, 
   3.6410425772538524`*^9}, {3.6411275811733403`*^9, 3.641127758810852*^9}, {
   3.6411278095109415`*^9, 3.6411278687608457`*^9}, {3.641128263591546*^9, 
   3.6411283186128435`*^9}, {3.64112838505336*^9, 3.641128385926961*^9}, {
   3.6411284218070245`*^9, 3.641128438951454*^9}, {3.6411308729863296`*^9, 
   3.6411309004735775`*^9}, {3.6411309360416403`*^9, 3.641131069858675*^9}, {
   3.6411311626874485`*^9, 3.641131204294828*^9}, {3.6411312614700985`*^9, 
   3.6411312939769573`*^9}, 3.6411313835080786`*^9, {3.641131429025682*^9, 
   3.6411314427734685`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"comp", "[", 
    RowBox[{
     RowBox[{"x_", "?", "NumericQ"}], ",", 
     RowBox[{"y_", "?", "NumericQ"}]}], "]"}], ":=", " ", 
   RowBox[{"x", " ", "+", 
    RowBox[{"I", " ", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mkvec2", "[", 
    RowBox[{
     RowBox[{"x01_", "?", "NumericQ"}], ",", 
     RowBox[{"x02_", "?", "NumericQ"}], ",", 
     RowBox[{"x03_", "?", "NumericQ"}], ",", 
     RowBox[{"x04_", "?", "NumericQ"}], ",", 
     RowBox[{"y01_", "?", "NumericQ"}], ",", 
     RowBox[{"y02_", "?", "NumericQ"}], ",", 
     RowBox[{"y03_", "?", "NumericQ"}], ",", 
     RowBox[{"y04_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"comp", "[", 
      RowBox[{"x01", ",", "y01"}], "]"}], ",", 
     RowBox[{"comp", "[", 
      RowBox[{"x02", ",", "y02"}], "]"}], ",", 
     RowBox[{"comp", "[", 
      RowBox[{"x03", ",", "y03"}], "]"}], ",", 
     RowBox[{"comp", "[", 
      RowBox[{"x04", ",", "y04"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"densmat", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"{", "v", "}"}], "]"}], ".", 
    RowBox[{"{", "v", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"densmat1", "[", "v_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", "v", "]"}], ".", "v"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pdensmat1", "[", "M_", "]"}], ":=", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{"M", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pdensmat2", "[", "M_", "]"}], ":=", " ", 
   RowBox[{"PartialTrace", "[", 
    RowBox[{"M", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NEntropy", "[", "M_", "]"}], ":=", 
   RowBox[{"Expand", "[", " ", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"MatrixLog", "[", "M", "]"}], ".", "M"}]}], "]"}], "/", 
     RowBox[{"Log", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"veckraus", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Finvec", "[", 
    RowBox[{
     RowBox[{"ar_", "?", "NumericQ"}], ",", 
     RowBox[{"br_", "?", "NumericQ"}], ",", 
     RowBox[{"cr_", "?", "NumericQ"}], ",", 
     RowBox[{"dr_", "?", "NumericQ"}], ",", 
     RowBox[{"ai_", "?", "NumericQ"}], ",", 
     RowBox[{"bi_", "?", "NumericQ"}], ",", 
     RowBox[{"ci_", "?", "NumericQ"}], ",", 
     RowBox[{"di_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"veckraus", "[", 
       RowBox[{
        RowBox[{"mkvec2", "[", 
         RowBox[{
          RowBox[{"Re", "[", "ar", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "br", "]"}], ",", 
          RowBox[{"Re", "[", "ai", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "bi", "]"}]}], "]"}], ",", 
        RowBox[{"mkvec2", "[", 
         RowBox[{
          RowBox[{"Re", "[", "cr", "]"}], ",", 
          RowBox[{"Re", "[", "dr", "]"}], ",", 
          RowBox[{"Re", "[", "ci", "]"}], ",", 
          RowBox[{"Re", "[", "di", "]"}], ",", 
          RowBox[{"Re", "[", "cr", "]"}], ",", 
          RowBox[{"Re", "[", "dr", "]"}], ",", 
          RowBox[{"Re", "[", "ci", "]"}], ",", 
          RowBox[{"Re", "[", "di", "]"}]}], "]"}]}], "]"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"veckraus", "[", 
       RowBox[{
        RowBox[{"mkvec2", "[", 
         RowBox[{
          RowBox[{"Re", "[", "br", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "ar", "]"}]}], ",", 
          RowBox[{"Re", "[", "bi", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "ai", "]"}]}]}], "]"}], ",", 
        RowBox[{"mkvec2", "[", 
         RowBox[{
          RowBox[{"Re", "[", "dr", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "cr", "]"}]}], ",", 
          RowBox[{"Re", "[", "di", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "ci", "]"}]}]}], "]"}]}], "]"}], "+", 
      RowBox[{"veckraus", "[", 
       RowBox[{
        RowBox[{"mkvec2", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Re", "[", "ar", "]"}], ",", 
          RowBox[{"Re", "[", "br", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "ai", "]"}], ",", 
          RowBox[{"Re", "[", "bi", "]"}], ",", "0"}], "]"}], ",", 
        RowBox[{"mkvec2", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Re", "[", "cr", "]"}], ",", 
          RowBox[{"Re", "[", "dr", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "ci", "]"}], ",", 
          RowBox[{"Re", "[", "di", "]"}], ",", "0"}], "]"}]}], "]"}], "+", 
      RowBox[{"veckraus", "[", 
       RowBox[{
        RowBox[{"mkvec2", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Re", "[", "br", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "ar", "]"}]}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "bi", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "ai", "]"}]}], ",", "0"}], "]"}], ",", 
        RowBox[{"mkvec2", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Re", "[", "dr", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "cr", "]"}]}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "di", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Re", "[", "ci", "]"}]}], ",", "0"}], "]"}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Optm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Optm", "[", 
    RowBox[{
     RowBox[{"ar_", "?", "NumericQ"}], ",", 
     RowBox[{"br_", "?", "NumericQ"}], ",", 
     RowBox[{"cr_", "?", "NumericQ"}], ",", 
     RowBox[{"dr_", "?", "NumericQ"}], ",", 
     RowBox[{"ai_", "?", "NumericQ"}], ",", 
     RowBox[{"bi_", "?", "NumericQ"}], ",", 
     RowBox[{"ci_", "?", "NumericQ"}], ",", 
     RowBox[{"di_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    RowBox[{
     RowBox[{"NEntropy", "[", 
      RowBox[{"pdensmat1", "[", 
       RowBox[{"densmat1", "[", 
        RowBox[{"Finvec", "[", 
         RowBox[{
         "ar", ",", "br", ",", "cr", ",", "dr", ",", "ai", ",", "bi", ",", 
          "ci", ",", "di"}], "]"}], "]"}], "]"}], "]"}], "-", " ", 
     RowBox[{"NEntropy", "[", 
      RowBox[{"pdensmat2", "[", 
       RowBox[{"densmat", "[", 
        RowBox[{"mkvec2", "[", 
         RowBox[{
          RowBox[{"Re", "[", "cr", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "dr", "]"}], ",", 
          RowBox[{"Re", "[", "ci", "]"}], ",", "0", ",", "0", ",", 
          RowBox[{"Re", "[", "di", "]"}]}], "]"}], "]"}], "]"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Optm", "[", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
   RowBox[{"1", "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0.636944", ",", "0", ",", "0", 
   ",", "0", ",", "0.770919", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Optm", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0.5", ",", "0.7", ",", "0.5", 
    ",", "0.3", ",", "0.1", ",", "0.3"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Optm", "[", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "cr", ",", "dr", ",", "0", ",", 
     "0", ",", "ci", ",", "di"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Clear", "[", "fu", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fu", "[", 
      RowBox[{
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"b_", "?", "NumericQ"}]}], "]"}], " ", "=", " ", 
     RowBox[{"veckraus", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", " ", "+", " ", 
           RowBox[{"I", " ", "b"}]}], ",", "0"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "+", 
           RowBox[{"I", " ", "b"}]}], ",", "0"}], "}"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"fu", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NumericQ", "[", "0", "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FindMaximum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Optm", "[", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "cr", ",", "dr", ",", "0", 
       ",", "0", ",", "ci", ",", "di"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"cr", "^", "2"}], "+", 
       RowBox[{"dr", "^", "2"}], "+", 
       RowBox[{"ci", "^", "2"}], "+", 
       RowBox[{"di", "^", "2"}]}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"cr", ",", "dr", ",", "ci", ",", "di"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.641039880873628*^9, 3.6410401224504457`*^9}, {
   3.641040156412388*^9, 3.641040360609068*^9}, {3.6410404260028076`*^9, 
   3.6410404547894545`*^9}, {3.6410404982269387`*^9, 3.6410409854058037`*^9}, 
   3.6410410488844347`*^9, {3.641041081426296*^9, 3.6410410854925284`*^9}, {
   3.6410411781468277`*^9, 3.6410412071774883`*^9}, {3.6410414109121413`*^9, 
   3.641041440404828*^9}, {3.641041471864628*^9, 3.641041483040267*^9}, {
   3.64104155443235*^9, 3.64104158135189*^9}, {3.6410416202391143`*^9, 
   3.6410416854048414`*^9}, {3.6410417222849507`*^9, 
   3.6410419277847047`*^9}, {3.6410419997998238`*^9, 
   3.6410421642792315`*^9}, {3.6410422079967318`*^9, 
   3.6410423348839893`*^9}, {3.641042537190561*^9, 3.641042540267737*^9}, {
   3.641042590691621*^9, 3.6410425912676535`*^9}, {3.6410427554880466`*^9, 
   3.6410427733830705`*^9}, {3.641042815323469*^9, 3.6410428497194366`*^9}, {
   3.6410428858255014`*^9, 3.641042974908597*^9}, {3.6410430105416346`*^9, 
   3.6410430770284376`*^9}, {3.6410431160426693`*^9, 3.641043230912239*^9}, {
   3.6410433122298903`*^9, 3.641043313473962*^9}, {3.641043915682406*^9, 
   3.641043939110746*^9}, {3.6410445731066017`*^9, 3.641044573313614*^9}, {
   3.6410446246235485`*^9, 3.6410446544832563`*^9}, {3.6410446935834928`*^9, 
   3.641044709480402*^9}, {3.6410447467165318`*^9, 3.6410447678647413`*^9}, {
   3.6410448105151806`*^9, 3.641044812339285*^9}, {3.641126896239137*^9, 
   3.641126981914488*^9}, {3.641127056842419*^9, 3.641127144590974*^9}, {
   3.6411271752918277`*^9, 3.641127178505433*^9}, {3.6411272090034866`*^9, 
   3.6411272094090877`*^9}, {3.641127244618349*^9, 3.6411272497975583`*^9}, {
   3.641127344162124*^9, 3.641127382834592*^9}, {3.6411274728779507`*^9, 
   3.6411274738763523`*^9}, {3.6411275142960234`*^9, 3.641127569005319*^9}, 
   3.6411276995619483`*^9, {3.641131404271266*^9, 3.6411314117836957`*^9}, {
   3.6411314674038773`*^9, 3.641131477467453*^9}, {3.641131511465397*^9, 
   3.641131566914569*^9}, {3.641131665567211*^9, 3.6411318271434526`*^9}, {
   3.6411319886876926`*^9, 3.641132022157607*^9}, {3.6411320977149286`*^9, 
   3.641132293272114*^9}, {3.6411323453580933`*^9, 3.6411323508524075`*^9}, {
   3.641132459279609*^9, 3.641132497646804*^9}, {3.641132580023515*^9, 
   3.641132631816478*^9}, {3.641132695205103*^9, 3.641132734821369*^9}, {
   3.641133157318535*^9, 3.641133159591665*^9}, {3.641133238423174*^9, 
   3.641133291774225*^9}, {3.64113334047101*^9, 3.641133346363347*^9}, {
   3.6411336904950304`*^9, 3.641133717319565*^9}, {3.641133748289336*^9, 
   3.6411337485163493`*^9}, {3.641133868220196*^9, 3.641133902929181*^9}, {
   3.6411339943234086`*^9, 3.641134005150028*^9}, {3.6411356630738554`*^9, 
   3.641135714794814*^9}, {3.641135749649808*^9, 3.6411358919439464`*^9}, {
   3.64113597051044*^9, 3.6411360215953617`*^9}, {3.64113607348633*^9, 
   3.641136083732916*^9}, {3.6411385610696115`*^9, 3.641138680886465*^9}, {
   3.641138714960414*^9, 3.6411387670803947`*^9}, {3.6411388583556156`*^9, 
   3.6411388925715723`*^9}, {3.6411392583494935`*^9, 3.641139312062566*^9}, {
   3.6411424411035366`*^9, 3.641142457193457*^9}, {3.6411425021530285`*^9, 
   3.6411426843164477`*^9}, {3.641142718151383*^9, 3.6411428346350455`*^9}, {
   3.641142908407265*^9, 3.6411429219840417`*^9}, {3.6411439641746516`*^9, 
   3.6411439776864243`*^9}, {3.6411440289603567`*^9, 
   3.6411440334216123`*^9}, {3.6411440916009398`*^9, 
   3.6411441465310817`*^9}, {3.6411443272144165`*^9, 3.641144345582467*^9}, {
   3.641144493930952*^9, 3.6411445197694297`*^9}, {3.6411445652900333`*^9, 
   3.6411446447085757`*^9}, {3.6411453170950336`*^9, 
   3.6411453641307244`*^9}, {3.641145400807822*^9, 3.641145465174504*^9}, {
   3.6411454960122676`*^9, 3.6411455043487444`*^9}, {3.641145675225518*^9, 
   3.641145735179947*^9}, 3.641146139701084*^9}],

Cell[BoxData["1.2067264668665452`"], "Output",
 CellChangeTimes->{
  3.6411453452626452`*^9, {3.6411453971946154`*^9, 3.6411454362708507`*^9}, {
   3.641145486372716*^9, 3.641145505309799*^9}, {3.6411456854111004`*^9, 
   3.6411457464085894`*^9}, 3.6411461417252007`*^9}],

Cell[BoxData[
 RowBox[{"-", "0.3771612441252973`"}]], "Output",
 CellChangeTimes->{
  3.6411453452626452`*^9, {3.6411453971946154`*^9, 3.6411454362708507`*^9}, {
   3.641145486372716*^9, 3.641145505309799*^9}, {3.6411456854111004`*^9, 
   3.6411457464085894`*^9}, 3.6411461417262*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3579048897666064`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cr", "\[Rule]", 
      RowBox[{"-", "0.7543711378847112`"}]}], ",", 
     RowBox[{"dr", "\[Rule]", 
      RowBox[{"-", "2.9809610788448433`*^-6"}]}], ",", 
     RowBox[{"ci", "\[Rule]", "0.6564481596524582`"}], ",", 
     RowBox[{"di", "\[Rule]", 
      RowBox[{"-", "2.9523475340035803`*^-6"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6411453452626452`*^9, {3.6411453971946154`*^9, 3.6411454362708507`*^9}, {
   3.641145486372716*^9, 3.641145505309799*^9}, {3.6411456854111004`*^9, 
   3.6411457464085894`*^9}, 3.641146143191284*^9}]
}, Open  ]]
},
WindowSize->{1350, 643},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.100000023841858,
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 589, 14, 53, "Input"],
Cell[1171, 38, 611, 14, 24, "Print"]
}, Open  ]],
Cell[1797, 55, 94, 1, 32, "Input"],
Cell[1894, 58, 10062, 239, 860, "Input"],
Cell[11959, 299, 4107, 79, 133, "Input"],
Cell[16069, 380, 19005, 398, 773, "Input"],
Cell[CellGroupData[{
Cell[35099, 782, 13759, 321, 553, "Input"],
Cell[48861, 1105, 271, 4, 32, "Output"],
Cell[49135, 1111, 284, 5, 32, "Output"],
Cell[49422, 1118, 661, 15, 34, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
